"use strict";(self.webpackChunkpayload_template_js_blog=self.webpackChunkpayload_template_js_blog||[]).push([[771],{59771:(e,a,t)=>{t.r(a),t.d(a,{default:()=>h});var i=t(67294),l=t(16550),o=t(26793),s=t(9980),n=t(28630),d=t(47489),r=t(2143),c=t(58951),u=t(83780);const f=(e,a)=>a?e.fields.filter((e=>(0,u.fieldAffectsData)(e)&&"id"!==e.name||!0)):e.fields;var p=t(19826),v=t(40684),m=t(45074),$=t(91455),g=t(30894);const h=e=>{var a,t,u;const{collection:h,isEditing:E}=e,{slug:S,admin:{components:{views:{Edit:b}={}}={}}={}}=h,[k]=(0,i.useState)((()=>f(h,E))),[_]=(0,i.useState)((()=>({...h,fields:k}))),[w,C]=(0,i.useState)(),Z=(0,v.bU)(),{serverURL:y,routes:{admin:P,api:L}}=(0,s.Z)(),{params:{id:U}={}}=(0,l.$B)(),{state:j}=(0,l.TH)(),D=(0,l.k6)(),[R,x]=(0,i.useState)(),{permissions:A,user:B}=(0,n.a)(),{getVersions:G,preferencesKey:H}=(0,m.x5)(),{getPreference:K}=(0,$.G)(),{t:T}=(0,o.$)("general"),V=(0,i.useCallback)((async e=>{var a;if(G(),E){const a=await(0,p.Z)({fieldSchema:_.fields,data:e.doc,user:B,id:U,operation:"update",locale:Z,t:T});x(a)}else C(`${P}/collections/${_.slug}/${null===(a=null==e?void 0:e.doc)||void 0===a?void 0:a.id}`)}),[P,_,E,G,B,U,T,Z]),[{data:q,isLoading:z,isError:F}]=(0,d.Z)(E?`${y}${L}/${S}/${U}`:null,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),I=(null==j?void 0:j.data)||q;if((0,i.useEffect)((()=>{if(z)return;(async()=>{const e=await(0,p.Z)({fieldSchema:k,data:I,user:B,operation:E?"update":"create",id:U,locale:Z,t:T});await K(H),x(e)})()}),[I,k,E,U,B,Z,z,H,K,T]),(0,i.useEffect)((()=>{w&&D.push(w)}),[D,w]),F)return i.createElement(l.l_,{to:`${P}/not-found`});const J=null===(a=null==A?void 0:A.collections)||void 0===a?void 0:a[S],M=`${y}${L}/${S}/${U}${_.versions.drafts?"?draft=true":""}`,N=`${y}${L}/${S}${E?`/${U}`:""}?locale=${Z}&depth=0&fallback-locale=null`,O=E&&(null===(t=null==J?void 0:J.update)||void 0===t?void 0:t.permission)||!E&&(null===(u=null==J?void 0:J.create)||void 0===u?void 0:u.permission);return i.createElement(g.f.Provider,{value:1},i.createElement(r.Z,{DefaultComponent:c.Z,CustomComponent:b,componentProps:{id:U,isLoading:!R,data:I,collection:_,permissions:J,isEditing:E,onSave:V,initialState:R,hasSavePermission:O,apiURL:M,action:N}}))}}}]);